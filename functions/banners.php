<?php
// Main 
function banner($version) {
	echo "\033[0;37m
                                   ,,           ,,                                                              
\033[0;31m `7MM\"\"\"YMM\033[0;37m                      `7MM           db   mm \033[0;31m    .g8\"\"8q.\033[0;37m          \033[0;31m      .g8\"\"\"bgd \033[0;37m`7MMF'      `7MMF'
\033[0;31m   MM    `7\033[0;37m                        MM                MM   \033[0;31m.dP'    `YM.  \033[0;37m          \033[0;31m.dP'     `M   \033[0;37mMM          MM
\033[0;31m   MM   d\033[0;37m    `7M'   `MF'`7MMpdMAo. MM  ,pW\"Wq.`7MM mmMMmm\033[0;31m dM'      `MM \033[0;37m`7MMpMMMb.\033[0;31m dM'       ` \033[0;37m  MM          MM
\033[0;31m   MMmmMM\033[0;37m      `VA ,V'    MM   `Wb MM 6W'   `Wb MM   MM   \033[0;31mMM        MM   \033[0;37mMM    MM \033[0;31mMM           \033[0;37m MM          MM
\033[0;31m   MM   Y  , \033[0;37m    XMX      MM    M8 MM 8M     M8 MM   MM   \033[0;31mMM.      ,MP   \033[0;37mMM    MM \033[0;31mMM.          \033[0;37m MM      ,   MM
\033[0;31m   MM     ,M \033[0;37m  ,V' VA.    MM   ,AP MM YA.   ,A9 MM   MM   \033[0;31m`Mb.    ,dP'   \033[0;37mMM    MM \033[0;31m`Mb.     ,'  \033[0;37m MM     ,M   MM
\033[0;31m .JMMmmmmMMM\033[0;37m .AM.   .MA.  MMbmmd'.JMML.`Ybmd9'.JMML. `Mbmo\033[0;31m  `\"bmmd\"'   \033[0;37m.JMML  JMML.\033[0;31m `\"bmmmd' \033[0;37m .JMMmmmmMMM .JMML.
                          MM
                        .JMML.
                        
\033[0;30m------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0;37m

 TOOL NAME \033[0;30m|\033[0;37m ExploitOnCLI \"aka\" EOC
 VERSION   \033[0;30m|\033[0;37m \033[0;31m" . $version . "\033[0;37m
 AUTOR     \033[0;30m|\033[0;37m ROOTmars(@sr_mdk)
 CONTACT   \033[0;30m|\033[0;37m mdk2@protonmail.com
 PATH      \033[0;30m|\033[0;37m " . getcwd () . "
 
\033[0;30m------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\033[0;37m
 HELP:: " . $_SERVER ['PHP_SELF'] . " --help
 USAGE: " . $_SERVER ['PHP_SELF'] . " --search/-s
    EX: " . $_SERVER ['PHP_SELF'] . " --search 'DokuWiki'
\033[0;30m------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\033[0;37m";
	
	$fu = array (
			"siph0n.txt",
			"iedb.txt",
			"exploitdb.txt",
			"exploit4arab.txt",
			"packetstorm.txt",
			"cxsecurity.txt" 
	);
	
	$fil = null;
	foreach ( $fu as $f ) {
		if (! file_exists ( "update/{$f}" )) {
			$fil [] = $f;
		}
	}
	
	if ($fil != null) {
		echo "\n \033[1;31m* \033[1;37m This files are \033[0;31mmissing\033[0;37m: \033[0;31m" . $fil [0];
		unset ( $fil [0] );
		
		foreach ( $fil as $a ) {
			echo "\033[0;30m, \033[0;31m" . $a;
		}
		
		echo "\n \033[1;31m*\033[1;37m  You must run the \033[0;31m" . $_SERVER ['PHP_SELF'] . " --update\033[1;37m option on the next initializing\n\n\033[0;37m
\033[0;30m------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0;37m";
	}
}

// About
function about() {
	die ( "         ,,                                   
        *MM                             mm    
         MM                             MM    
,6\"Yb.  MM,dMMb.   ,pW\"Wq.`7MM  `7MM mmMMmm  
8)   MM  MM    `Mb 6W'   `Wb MM    MM   MM    
 ,pm9MM  MM     M8 8M     M8 MM    MM   MM    
8M   MM  MM.   ,M9 YA.   ,A9 MM    MM   MM    
`Moo9^Yo.P^YbmdP'   `Ybmd9'  `Mbod\"YML. `Mbmo \n
\033[0;30m------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0;37m

 \033[0;31mTO RUN THE SCRIPT\033[0;37m
 \033[0;30m-----------------\033[0;37m
 
  PHP Version       7.0.19-1 (cli)
   php7.0-cli        Lib
  cURL support      Enabled
   php7.0-curl       Lib
  cURL Version      7.52.1
  allow_url_fopen   On
  Permission        Writing/Reading
 
 \033[0;31mABOUT DEVELOPER\033[0;37m
 \033[0;30m-----------------\033[0;37m
  Autor             ROOTmars
  Email             mdk2@protonmail.com
  Twitter           https://twitter.com/sr_mdk
  Github            https://github.com/r00tmars
 
 \033[0;31mABOUT TOOL\033[0;37m
 \033[0;30m-----------------\033[0;37m
 
 \033[0;31mE\033[0;37mxploit\033[0;31mO\033[0;37mn\033[0;37mC\033[0;31mLI\033[0;37m or '\033[0;31mEOC\033[0;37m' is a tool written in PHP for Linux, 
 designed to search for exploits in multiple exploit 
 databases (no online search will be performed, but yes in a local file), the databases are:
 
  \033[0;31m*\033[0;37m Siph0n
  \033[0;31m*\033[0;37m IEDB
  \033[0;31m*\033[0;37m Exploit-DB
  \033[0;31m*\033[0;37m CXSecurity
  \033[0;31m*\033[0;37m PacketStorm
  \033[0;31m*\033[0;37m Exploit4Arab

\033[0;30m------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0;37m
" );
}

// Help
function help() {
	die ( "  ,,                 ,,            
`7MM               `7MM            
  MM                 MM            
  MMpMMMb.  .gP\"Ya   MM `7MMpdMAo. 
  MM    MM ,M'   Yb  MM   MM   `Wb 
  MM    MM 8M\"\"\"\"\"\"  MM   MM    M8 
  MM    MM YM.    ,  MM   MM   ,AP 
.JMML  JMML.`Mbmmd'.JMML. MMbmmd'  
                          MM       
                        .JMML.\n 

 \033[0;31mOPTIONS\033[0;37m
 \033[0;30m-----------------\033[0;37m

                                      Simple search:\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--search\033[0;30m/\033[0;31m-s\033[0;37m
                                                 EX:\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--search\033[0;30m/\033[0;31m-s\033[0;37m \033[1;37mRobotCPA\033[0;37m

                                      Simple update:\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--update\033[0;37m

                         Update a specific database:\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--update=\033[1;37mDBS\033[0;37m
                                                 EX:\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--update=\033[1;37miedb\033[0;37m
                                                EX2:\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--update=\033[1;37miedb,packetstorm\033[0;37m
                     
                                           For help:\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--help\033[0;30m/\033[0;31m-h\033[0;37m

                                        For 'about':\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--about\033[0;30m/\033[0;31m-a\033[0;37m 
                
 Option to download the results to the local folder:\033[1;37m root@root ~ \033[1;34m#\033[1;37m php exploitoncli.php \033[0;31m--down\033[0;30m/\033[0;31m-d\033[0;37m 
                
                
                
                
                \n\n" );
}

?>